<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ–°é—»è¯¦æƒ… - æ¾³æ¸¯çœæ—¥æŠ¥</title>
    <link rel="stylesheet" href="./fcyym.css" />
    <style>
        /* å…¨å±€èƒŒæ™¯æ”¹ä¸ºç™½è‰² - ä¸search2ä¸€è‡´ */
        body {
            background-color: #ffffff !important;
            margin: 0;
            padding: 0;
            font-family: 'SimSun', 'å®‹ä½“', 'Microsoft YaHei', sans-serif;
        }

        /* å¤§å¹…åŠ å®½æ•´ä½“å®¹å™¨å®½åº¦ - ä¸search2ä¸€è‡´ */
        .w1000 {
            width: 1400px !important;
            margin: 0 auto;
            display: flex;
        }

        /* æ¢å¤å·¦å³å¹¶æ’å¸ƒå±€ - ä¸search2å®Œå…¨ä¸€è‡´ */
        .main {
            display: flex;
            justify-content: space-between;
            gap: 30px !important;
            padding: 0 20px;
        }

        /* å·¦ä¾§å†…å®¹åŒº - å®½åº¦å’Œæ ·å¼ä¸search2å·¦ä¾§æ å®Œå…¨ä¸€è‡´ */
        .paper-box {
            width: 20% !important; /* ä¸search2å·¦ä¾§å®½åº¦ä¸€è‡´ */
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            background: #fff;
            border: 1px solid #e4e4e4;
            padding: 20px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
        }

        /* å³ä¾§å†…å®¹åŒº - å®½åº¦å’Œæ ·å¼ä¸search2å³ä¾§æ€ç»´å¯¼å›¾å®¹å™¨å®Œå…¨ä¸€è‡´ */
        .right-main {
            width: 75% !important; /* ä¸search2å³ä¾§å®½åº¦ä¸€è‡´ */
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #fff;
            border: 1px solid #e4e4e4;
            padding: 28px 32px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
            position: relative;
        }

        /* è°ƒæ•´æŠ¥çº¸å›¾ç‰‡å¤§å° */
        .paper img {
            width: 100% !important;
            max-width: 700px;
            height: auto !important;
        }

        /* ç›¸å…³æ–°é—»åˆ—è¡¨å¸ƒå±€ - é å·¦æ•´é½æ’åˆ— */
        .news-list {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 10px;
            padding: 0;
            list-style: none;
            font-size: 17px;
            width: 100%;
        }

        /* æ¿å—æŒ‰é’®ç½‘æ ¼ - 3è¡Œ4åˆ— */
        .swiper-container {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 2px;
            padding: 0;
            width: 100%;
            margin-bottom: 20px;
        }

        /* æ¿å—æŒ‰é’®æ ·å¼ - ä½¿ç”¨search2çš„çº¢è‰² */
        .swiper-slide {
            background-color: #d7000f;
            color: white;
            font-size: 18px;
            text-align: center;
            padding: 12px 0;
            box-sizing: border-box;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 60px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .swiper-slide:hover {
            background-color: #b0000c;
        }

        .swiper-slide a {
            color: white;
            text-decoration: none;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* æ–‡ç« åŒºåŸŸ - è°ƒæ•´ä¸Šä¸‹æ¯”ä¾‹ï¼Œæ•´ä½“ä¸Šç§» */
        .article-box {
            width: 100%;
            max-width: none !important;
            display: flex;
            flex-direction: column;
            margin-top: -10px; /* æ•´ä½“ä¸Šç§» */
        }

        /* æ“ä½œæŒ‰é’®åŒºåŸŸ - ä»search2çš„å¯¼èˆªé£æ ¼æ¼”åŒ–è€Œæ¥ */
        .art-btn {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 20px;
            background-color: #f5f5f5;
            width: 100%;
            box-sizing: border-box;
            margin-bottom: 5px;
            margin-top: 0;
            border-radius: 4px 4px 0 0;
            border: 1px solid #e4e4e4;
        }

        .art-btn span a, .art-btn a, .art-btn strong a {
            margin: 0 12px;
            text-decoration: none;
            color: #333;
            font-size: 15px;
        }

        .art-btn a:hover {
            color: #d7000f;
        }

        /* æ–‡ç« å†…å®¹å®¹å™¨ - è®¾ç½®é»˜è®¤æœ€å°é«˜åº¦ï¼Œå†…å®¹è¶…å‡ºæ—¶è‡ªåŠ¨å»¶ä¼¸ */
        .article {
            width: 100%;
            text-align: center;
            background-color: #ffffff;
            border-top: 1px solid #eee;
            min-height: 600px; /* è®¾ç½®é»˜è®¤æœ€å°é«˜åº¦ */
            height: auto; /* é«˜åº¦è‡ªåŠ¨ï¼Œç”±å†…å®¹æ’‘å¼€ */
        }

        #ozoom {
            text-align: left;
            line-height: 1.8;
            font-size: 18px;
            padding: 0 15px 20px 15px;
        }

        /* éšè—çº¿ç´¢é«˜äº®æ ·å¼ */
        .hidden-clue {
            background-color: #fff3cd;
            border-bottom: 2px dashed #ffc107;
            cursor: help;
            position: relative;
        }

        .hidden-clue:hover::after {
            content: attr(data-clue);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 1000;
        }

        /* å…³è”æ–‡ç« æç¤º - å·¦ä¾§åˆ—è¡¨æ ·å¼ */
        .related-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-left: 4px solid #d7000f;
            text-align: left;
            width: 100%;
            box-sizing: border-box;
        }

        .related-box h4 {
            margin-top: 0;
            margin-bottom: 12px;
            color: #d7000f;
            font-size: 16px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
        }

        .related-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .related-list li {
            margin: 8px 0;
            font-size: 15px;
        }

        .related-list a {
            color: #333;
            text-decoration: none;
        }

        .related-list a:hover {
            color: #d7000f;
            text-decoration: underline;
        }

        /* éšè—é¡µè„šç‰ˆæƒä¿¡æ¯ */
        .copyright {
            display: none !important;
        }

        /* é¡¶éƒ¨å¯¼èˆª - ä¸search2å®Œå…¨ä¸€è‡´ */
        .top {
            background: #fff;
            border-bottom: 1px solid #e0e0e0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .top .w1000 {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
        }

        /* è¡Œæ¥·æ–‡å­—logo - é¢œè‰²æ”¹ä¸ºsearch2çš„ff0040 */
        .logo {
            font-family: "STXingkai", "Microsoft YaHei", sans-serif;
            font-size: 28px;
            color: #ff0040;
            text-decoration: none;
            font-weight: 500;
        }

        .nav {
            display: flex;
            gap: 35px;
            font-size: 17px;
            position: relative;
        }
        
        /* ä¸‹æ‹‰èœå•æ ·å¼ */
        .nav li {
            list-style: none;
            position: relative;
            cursor: pointer;
        }
        
        .nav ul {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 1px solid #ccc;
            padding: 8px 0;
            min-width: 120px;
            z-index: 1000;
        }
        
        .nav li:hover ul {
            display: block;
        }
        
        .nav ul li {
            padding: 5px 15px;
            white-space: nowrap;
        }
        
        .nav ul li:hover {
            background-color: #f5f5f5;
        }
        
        .nav ul li a {
            color: #333;
            text-decoration: none;
        }

        .news-list li {
            width: 100%;
            text-align: left;
        }

        /* åŠ è½½çŠ¶æ€ */
        .loading {
            padding: 50px;
            text-align: center;
            font-size: 18px;
            color: #666;
        }

        /* é”™è¯¯çŠ¶æ€ */
        .error {
            padding: 50px;
            text-align: center;
            font-size: 18px;
            color: #d7000f;
        }

        /* æœç´¢æ¡†æç¤ºï¼ˆæ¸¸æˆå†…ä½¿ç”¨ï¼‰ */
        .search-hint {
            background-color: #e9ecef;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            text-align: left;
            font-size: 14px;
            color: #666;
            margin-top: -5px; /* ç¨å¾®ä¸Šç§»ï¼Œé…åˆæ•´ä½“ä¸Šç§» */
            width: 100%;
            box-sizing: border-box;
        }

        .search-hint strong {
            color: #d7000f;
        }

        /* å·¦ä¾§æ ‡é¢˜æ ·å¼ */
        .paper-box h3 {
            font-size: 16px;
            color: #d7000f;
            margin: 15px 0 10px 0;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            width: 100%;
        }

        /* å·¦ä¾§æ–°é—»åˆ—è¡¨å®¹å™¨ */
        .paper-box .news {
            width: 100%;
        }

        /* ç§»é™¤æ—¥æœŸå®¹å™¨ - å®Œå…¨éšè— */
        .date-box {
            display: none !important;
        }

        /* æ¿å—ç½‘æ ¼ä¸Šç§»ï¼Œå¡«è¡¥æ—¥æœŸç§»é™¤åçš„ç©ºé—´ */
        .swiper-box {
            margin-top: -20px;
            width: 100%;
        }

        /* åº•éƒ¨æ ·å¼ - ä¸search2ä¸€è‡´ */
        .bottom {
            background: #fff;
            border-top: 1px solid #e0e0e0;
            padding: 26px 0 40px;
        }

        /* è¿”å›é¡¶éƒ¨ - ä¸search2ä¸€è‡´ */
        .go-top {
            position: fixed;
            right: 32px;
            bottom: 48px;
            width: 48px;
            height: 48px;
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 8px 18px rgba(0, 0, 0, 0.16);
            overflow: hidden;
            transition: transform 0.2s ease;
            background: #fff;
            opacity: 0;
            pointer-events: none;
        }

        .go-top:hover {
            transform: translateY(-6px);
        }

        .go-top img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* å¼•å…¥åœ¨çº¿è¡Œæ¥·å­—ä½“ */
        @font-face {
            font-family: 'STXingkai';
            src: url('https://fonts.gstatic.com/s/notosanssc/v24/k3k68XPNpWRmgQ73v60CSLpGF90me5j.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
        }
    </style>
</head>
<body>
    <div class="top">
        <div class="w1000">
            <!-- logoé¢œè‰²æ”¹ä¸ºff0040ï¼Œä¸search2ä¸€è‡´ -->
            <a class="logo" href="search.html" rel="noreferrer">æ¾³æ¸¯çœæ—¥æŠ¥</a>
            <ul class="nav">
                <li id="ribao">
                    æ—¥æŠ¥
                    <ul class="ribao">
                        <li><a href="http://paper.people.com.cn/paperindex.htm" target="_blank" rel="noreferrer">äººæ°‘æ—¥æŠ¥</a></li>
                        <li><a href="http://paper.people.com.cn/rmrbhwb/paperindex.htm" target="_blank" rel="noreferrer">äººæ°‘æ—¥æŠ¥æµ·å¤–ç‰ˆ</a></li>
                        <li><a href="http://www.huanqiu.com/" target="_blank" rel="noreferrer">ç¯çƒæ—¶æŠ¥</a></li>
                        <li><a href="http://epaper.stcn.com/" target="_blank" rel="noreferrer">è¯åˆ¸æ—¶æŠ¥</a></li>
                    </ul>
                </li>
                <li id="zhoubao">
                    å‘¨æŠ¥
                    <ul class="zhoubao">
                        <li><a href="http://paper.people.com.cn/gjjrb/paperindex.htm" target="_blank" rel="noreferrer">å›½é™…é‡‘èæŠ¥</a></li>
                        <li><a href="http://paper.people.com.cn/zgnyb/paperindex.htm" target="_blank" rel="noreferrer">ä¸­å›½èƒ½æºæŠ¥</a></li>
                        <li><a href="http://paper.people.com.cn/jksb/paperindex.htm" target="_blank" rel="noreferrer">å¥åº·æ—¶æŠ¥</a></li>
                        <li><a href="http://paper.people.com.cn/fcyym/paperindex.htm" target="_blank" rel="noreferrer">è®½åˆºä¸å¹½é»˜</a></li>
                        <li><a href="http://paper.people.com.cn/zgcsb/paperindex.htm" target="_blank" rel="noreferrer">ä¸­å›½åŸå¸‚æŠ¥</a></li>
                    </ul>
                </li>
                <li id="zazhi">
                    æ‚å¿—
                    <ul class="zazhi">
                        <li><a href="http://paper.people.com.cn/xwzx/paperindex.htm" target="_blank" rel="noreferrer">æ–°é—»æˆ˜çº¿</a></li>
                        <li><a href="http://paper.people.com.cn/rmlt/paperindex.htm" target="_blank" rel="noreferrer">äººæ°‘è®ºå›</a></li>
                        <li><a href="http://paper.people.com.cn/rmzk/paperindex.htm" target="_blank" rel="noreferrer">äººæ°‘å‘¨åˆŠ</a></li>
                        <li><a href="http://paper.people.com.cn/zgjjzk/paperindex.htm" target="_blank" rel="noreferrer">ä¸­å›½ç»æµå‘¨åˆŠ</a></li>
                        <li><a href="http://paper.people.com.cn/mszk/paperindex.htm" target="_blank" rel="noreferrer">æ°‘ç”Ÿå‘¨åˆŠ</a></li>
                        <li><a href="https://www.gjrwls.com/" target="_blank" rel="noreferrer">å›½å®¶äººæ–‡å†å²</a></li>
                        <li><a href="http://paper.people.com.cn/zgby/paperindex.htm" target="_blank" rel="noreferrer">ä¸­å›½æŠ¥ä¸š</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <div class="main w1000">
        <!-- å·¦ä¾§ï¼šæŠ¥çº¸å›¾ç‰‡ + ç›¸å…³æ–°é—» - å®½åº¦20%ï¼Œä¸search2å·¦ä¾§æ å®Œå…¨ä¸€è‡´ -->
        <div class="paper-box">
            <div class="paper">
                <img id="paper-image" src="" alt="" width="400" height="575" />
            </div>
            <div class="paper-bot">
                <p class="ban" id="paper-section">åŠ è½½ä¸­...</p>
            </div>
            <!-- æ–°é—»åŒºåŸŸï¼šæ˜¾ç¤ºâ€œç›¸å…³æ–°é—»â€ -->
            <div class="news">
                <h3>ğŸ“ ç›¸å…³æ–°é—»</h3>
                <ul class="news-list" id="sidebar-related">
                    <!-- åŠ¨æ€ç”Ÿæˆç›¸å…³æ–°é—»åˆ—è¡¨ -->
                </ul>
            </div>
        </div>

        <!-- å³ä¾§ï¼šå†…å®¹åŒºåŸŸ - å®½åº¦75%ï¼Œä¸search2å³ä¾§æ€ç»´å¯¼å›¾å®¹å™¨å®Œå…¨ä¸€è‡´ -->
        <div class="right-main">
            <!-- æ—¥æœŸå®¹å™¨å·²è¢«å®Œå…¨éšè—ï¼Œä¸å†æ˜¾ç¤º -->

            <!-- æ¸¸æˆå†…æœç´¢æç¤º - ä¸Šç§» -->
            <div class="search-hint" id="search-hint" style="display: none;">
                <strong>è°ƒæŸ¥çº¿ç´¢ï¼š</strong>æœ¬æ–‡å¯èƒ½åŒ…å«å‡ å¤„éšè—çº¿ç´¢ï¼Œå¯ç”¨äºæ–°çš„æœç´¢ï¼Œä½†å¯èƒ½å­˜åœ¨è¯¯å¯¼é¡¹ã€‚ï¼ˆ0å¤„éšè—çº¿ç´¢çš„æ–°é—»ä¸å­˜åœ¨è¯¯å¯¼é¡¹ï¼‰
            </div>

            <div class="swiper-box">
                <div class="swiper-container" id="section-grid">
                    <!-- åŠ¨æ€ç”Ÿæˆæ¿å—æŒ‰é’® -->
                </div>
            </div>

            <!-- æ–‡ç« åŒºåŸŸ - æ•´ä½“ä¸Šç§»ï¼ŒæŒ‰é’®æ ·å¼ä¸search2å¯¼èˆªåè°ƒ -->
            <div class="article-box">
                <!-- æ“ä½œæŒ‰é’®åŒºåŸŸ - é‡‡ç”¨ä¸search2å¯¼èˆªåè°ƒçš„æ ·å¼ -->
                <div class="art-btn">
                    <span><a href="search.html">è¿”å›æœç´¢</a></span>
                    <a class="big" href="#" data-action="zoom-in">æ”¾å¤§</a>
                    <a class="small" href="#" data-action="zoom-out">ç¼©å°</a>
                    <a class="copy" href="#" data-action="copy">å…¨æ–‡å¤åˆ¶</a>
                    <strong>
                        <a href="#" id="prev-article">ä¸Šä¸€ç¯‡</a>
                        <a href="#" id="next-article">ä¸‹ä¸€ç¯‡</a>
                    </strong>
                </div>
                
                <!-- æ–‡ç« å†…å®¹å®¹å™¨ - è®¾ç½®é»˜è®¤æœ€å°é«˜åº¦ï¼Œå†…å®¹è¶…å‡ºæ—¶è‡ªåŠ¨å»¶ä¼¸ -->
                <div class="article" id="article-content">
                    <div class="loading">æ­£åœ¨åŠ è½½æ–°é—»å†…å®¹...</div>
                </div>
            </div>
        </div>
    </div>

    <div class="bottom">
        <div class="w1000">
            <div class="copyright"></div>
        </div>
    </div>

    <div class="go-top" id="go-top" aria-label="è¿”å›é¡¶éƒ¨">
        <img src="https://paper.people.com.cn/testx/template/amucsite/projectPaper/rmPaper/files/go_top.png" alt="è¿”å›é¡¶éƒ¨" />
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€ç®¡ç†ï¼ˆä½¿ç”¨ localStorage æŒä¹…åŒ–ï¼‰
        const GameState = {
            STORAGE_KEY: 'news_game_state',
            
            getState() {
                try {
                    const saved = localStorage.getItem(this.STORAGE_KEY);
                    if (saved) {
                        return JSON.parse(saved);
                    }
                } catch (e) {
                    console.error('è¯»å–å­˜æ¡£å¤±è´¥:', e);
                }
                return {
                    unlockedArticles: ['article_001'], // é»˜è®¤è§£é”ç¬¬ä¸€ç¯‡
                    discoveredClues: [],
                    searchHistory: []
                };
            },
            
            saveState(state) {
                try {
                    localStorage.setItem(this.STORAGE_KEY, JSON.stringify(state));
                } catch (e) {
                    console.error('ä¿å­˜å­˜æ¡£å¤±è´¥:', e);
                }
            },
            
            unlockArticle(articleId) {
                const state = this.getState();
                if (!state.unlockedArticles.includes(articleId)) {
                    state.unlockedArticles.push(articleId);
                    this.saveState(state);
                    return true; // æ–°è§£é”
                }
                return false; // å·²è§£é”
            },
            
            isUnlocked(articleId) {
                return this.getState().unlockedArticles.includes(articleId);
            },
            
            addDiscoveredClue(clue) {
                const state = this.getState();
                if (!state.discoveredClues.includes(clue)) {
                    state.discoveredClues.push(clue);
                    this.saveState(state);
                }
            }
        };

        // ä»URLè·å–æ–‡ç« ID
        function getArticleIdFromUrl() {
            const params = new URLSearchParams(window.location.search);
            return params.get('id') || 'article_001';
        }

        // å…¨å±€æ•°æ®å­˜å‚¨
        let newsDatabase = null;

        // å®‰å…¨è·å–DOMå…ƒç´ 
        function getElement(id) {
            const el = document.getElementById(id);
            if (!el) {
                console.warn(`å…ƒç´ æœªæ‰¾åˆ°: #${id}`);
            }
            return el;
        }

        // ä»JSONæ–‡ä»¶åŠ è½½æ•°æ®
        async function loadNewsData() {
            try {
                console.log('æ­£åœ¨åŠ è½½æ–°é—»æ•°æ®...');
                const response = await fetch('./news_database.json');
                if (!response.ok) {
                    throw new Error(`HTTPé”™è¯¯: ${response.status}`);
                }
                newsDatabase = await response.json();
                console.log('æ•°æ®åŠ è½½æˆåŠŸ:', newsDatabase);
                return true;
            } catch (error) {
                console.error('åŠ è½½æ•°æ®å¤±è´¥:', error);
                const contentEl = getElement('article-content');
                if (contentEl) {
                    contentEl.innerHTML = 
                        `<div class="error">
                            <h3>åŠ è½½å¤±è´¥</h3>
                            <p>${error.message}</p>
                            <p>è¯·ç¡®ä¿ news_database.json æ–‡ä»¶å­˜åœ¨ä¸”å¯è®¿é—®ã€‚</p>
                            <br>
                            <button onclick="location.reload()">é‡è¯•</button>
                        </div>`;
                }
                return false;
            }
        }

        // æ¸²æŸ“æ–‡ç« å†…å®¹
        function renderArticle(articleId) {
            console.log('æ¸²æŸ“æ–‡ç« :', articleId);
            
            if (!newsDatabase) {
                console.error('æ•°æ®æœªåŠ è½½');
                const contentEl = getElement('article-content');
                if (contentEl) {
                    contentEl.innerHTML = '<div class="error">æ•°æ®æœªåŠ è½½</div>';
                }
                return;
            }

            const article = newsDatabase.articles[articleId];
            if (!article) {
                console.error('æ–‡ç« æœªæ‰¾åˆ°:', articleId);
                const contentEl = getElement('article-content');
                if (contentEl) {
                    contentEl.innerHTML = 
                        `<div class="error">
                            <h3>æ–‡ç« æœªæ‰¾åˆ°</h3>
                            <p>ID: ${articleId}</p>
                        </div>`;
                }
                return;
            }

            // æ£€æŸ¥è§£é”çŠ¶æ€
            if (!GameState.isUnlocked(articleId)) {
                console.log('æ–‡ç« æœªè§£é”:', articleId);
                const contentEl = getElement('article-content');
                if (contentEl) {
                    contentEl.innerHTML = 
                        `<div class="error">
                            <h3>ğŸ”’ å†…å®¹æœªè§£é”</h3>
                            <p>è¯¥æ–°é—»éœ€è¦é€šè¿‡æœç´¢ç›¸å…³å…³é”®è¯è§£é”ã€‚</p>
                            <br>
                            <a href="search.html" style="color: #d7000f;">è¿”å›æœç´¢é¡µé¢</a>
                        </div>`;
                }
                
                // éšè—å…¶ä»–å…ƒç´ 
                const searchHint = getElement('search-hint');
                if (searchHint) searchHint.style.display = 'none';
                
                // å·¦ä¾§ç›¸å…³æ–°é—»æ¸…ç©º
                const sidebarRelated = getElement('sidebar-related');
                if (sidebarRelated) sidebarRelated.innerHTML = '<li style="color: #999;">è§£é”åå¯æŸ¥çœ‹ç›¸å…³æ–°é—»</li>';
                
                return;
            }

            // è§£é”å…³è”æ–‡ç« ï¼ˆåœ¨æ˜¾ç¤ºå…³è”æ–°é—»ä¹‹å‰å…ˆè§£é”ï¼Œä»¥ä¾¿ä¸‹æ–¹èƒ½æ˜¾ç¤ºæ–°è§£é”çš„æ–‡ç« ï¼‰
            if (article.related_articles) {
                article.related_articles.forEach(relatedId => {
                    GameState.unlockArticle(relatedId);
                });
            }

            // æ›´æ–°é¡µé¢æ ‡é¢˜
            document.title = `${article.title} - æ¾³æ¸¯çœæ—¥æŠ¥`;

            // å®‰å…¨æ›´æ–°DOMå…ƒç´ 
            const paperImage = getElement('paper-image');
            const paperSection = getElement('paper-section');
            
            if (paperImage) {
                paperImage.src = article.image || 'https://paper.people.com.cn/fcyym/pic/202601/30/06869d17-30e9-48f4-911a-beb0bc460ff4.jpg.2';
                paperImage.alt = article.section || '';
            }
            
            if (paperSection) {
                paperSection.textContent = article.section || '';
            }

            // ç”Ÿæˆæ–‡ç« å†…å®¹ï¼ˆå¸¦éšè—çº¿ç´¢é«˜äº®ï¼‰
            const contentEl = getElement('article-content');
            if (!contentEl) {
                console.error('æ–‡ç« å®¹å™¨æœªæ‰¾åˆ°');
                return;
            }

            let contentHtml = `
                <h3>${article.subtitle || ''}</h3>
                <h1>${article.title || ''}</h1>
                <h2></h2>
                <p class="sec">
                    æ–‡ | ${article.author || 'æœªçŸ¥'}
                    <span class="date">ã€Š${article.source || 'æ¾³æ¸¯çœæ—¥æŠ¥'}ã€‹ï¼ˆ<span class="newstime">${article.date || ''}</span>&nbsp;${article.section || ''}ï¼‰</span>
                </p>
                <div class="attachment"></div>
                <div id="ozoom" style="font-size: 18px;">
            `;

            // å¤„ç†æ®µè½ï¼Œé«˜äº®éšè—çº¿ç´¢
            if (article.content && Array.isArray(article.content)) {
                article.content.forEach((paragraph) => {
                    let processedParagraph = paragraph;
                    
                    // æ£€æŸ¥æ˜¯å¦åŒ…å«éšè—çº¿ç´¢å…³é”®è¯
                    if (article.hidden_clues && Array.isArray(article.hidden_clues)) {
                        article.hidden_clues.forEach((clue) => {
                            const clueParts = clue.split(' â†’ ');
                            const clueText = clueParts[0];
                            const clueHint = clueParts[1] || '';
                            
                            if (paragraph.includes(clueText)) {
                                processedParagraph = processedParagraph.replace(
                                    clueText, 
                                    `<span class="hidden-clue" data-clue="${clueHint}">${clueText}</span>`
                                );
                                GameState.addDiscoveredClue(clue);
                            }
                        });
                    }

                    contentHtml += `<p>${processedParagraph}</p>`;
                });
            }

            contentHtml += '</div>';
            contentEl.innerHTML = contentHtml;

            // æ˜¾ç¤ºçº¿ç´¢æç¤º
            const searchHint = getElement('search-hint');
            const clueCount = getElement('clue-count');
            if (searchHint && article.hidden_clues && article.hidden_clues.length > 0) {
                searchHint.style.display = 'block';
                if (clueCount) {
                    clueCount.textContent = article.hidden_clues.length;
                }
            } else if (searchHint) {
                searchHint.style.display = 'none';
            }

            // ç”Ÿæˆå·¦ä¾§ç›¸å…³æ–°é—»åˆ—è¡¨
            renderSidebarRelated(article);

            // ç”Ÿæˆæ¿å—å¯¼èˆªç½‘æ ¼
            renderSectionGrid();

            // è®¾ç½®ä¸Šä¸€ç¯‡/ä¸‹ä¸€ç¯‡é“¾æ¥
            renderNavigation(articleId);
        }

        // æ¸²æŸ“å·¦ä¾§ç›¸å…³æ–°é—»
        function renderSidebarRelated(currentArticle) {
            const sidebarRelated = getElement('sidebar-related');
            if (!sidebarRelated) {
                console.warn('å·¦ä¾§ç›¸å…³æ–°é—»å®¹å™¨æœªæ‰¾åˆ°');
                return;
            }

            sidebarRelated.innerHTML = '';

            if (!currentArticle.related_articles || currentArticle.related_articles.length === 0) {
                sidebarRelated.innerHTML = '<li style="color: #999;">æš‚æ— ç›¸å…³æ–°é—»</li>';
                return;
            }

            currentArticle.related_articles.forEach(relatedId => {
                const related = newsDatabase.articles[relatedId];
                if (related) {
                    const li = document.createElement('li');
                    // æ£€æŸ¥æ˜¯å¦å·²è§£é”
                    const isUnlocked = GameState.isUnlocked(relatedId);
                    
                    if (isUnlocked) {
                        li.innerHTML = `<a href="?id=${relatedId}">${related.title}</a>`;
                    } else {
                        li.innerHTML = `<span style="color: #999;">ğŸ”’ ${related.title}ï¼ˆæœªè§£é”ï¼‰</span>`;
                    }
                    
                    sidebarRelated.appendChild(li);
                }
            });

            // å¦‚æœæ²¡æœ‰æ·»åŠ ä»»ä½•é¡¹ï¼Œæ˜¾ç¤ºå ä½
            if (sidebarRelated.children.length === 0) {
                sidebarRelated.innerHTML = '<li style="color: #999;">æš‚æ— ç›¸å…³æ–°é—»</li>';
            }
        }

        // æ¸²æŸ“æ¿å—å¯¼èˆª
        function renderSectionGrid() {
            const sectionGrid = getElement('section-grid');
            if (!sectionGrid) {
                console.warn('æ¿å—å¯¼èˆªæœªæ‰¾åˆ°');
                return;
            }

            sectionGrid.innerHTML = '';
            
            const sections = [
                {name: '01ç‰ˆï¼šè¦é—»', id: '01'}, {name: '02ç‰ˆï¼šç¤¾ä¼šèµ°ç¬”', id: '02'},
                {name: '03ç‰ˆï¼šä¼—ç”Ÿç›¸', id: '03'}, {name: '04ç‰ˆï¼šæ¼«ç”»ç”Ÿæ´»', id: '04'},
                {name: '05ç‰ˆï¼šå¤–å›½å¹½é»˜', id: '05'}, {name: '06ç‰ˆï¼šå¼€å¿ƒé©¿ç«™', id: '06'},
                {name: '07ç‰ˆï¼šç§‘æŠ€å‰æ²¿', id: '07'}, {name: '08ç‰ˆï¼šæ¼«ç”»è§‚å¯Ÿ', id: '08'},
                {name: '09ç‰ˆï¼šæ–°ç”Ÿä»£', id: '09'}, {name: '10ç‰ˆï¼šè§£å¿§é¦†', id: '10'},
                {name: '11ç‰ˆï¼šç¤¾ä¼šè¶£ç”»', id: '11'}, {name: '12ç‰ˆï¼šåŠ¨æ¼«', id: '12'}
            ];

            sections.forEach(sec => {
                const div = document.createElement('div');
                div.className = 'swiper-slide';
                div.innerHTML = `<a href="#">${sec.name}</a>`;
                sectionGrid.appendChild(div);
            });
        }

        // æ¸²æŸ“ä¸Šä¸€ç¯‡/ä¸‹ä¸€ç¯‡å¯¼èˆª
        function renderNavigation(currentId) {
            if (!newsDatabase || !newsDatabase.articles) {
                console.warn('æ•°æ®æœªåŠ è½½ï¼Œæ— æ³•æ¸²æŸ“å¯¼èˆª');
                return;
            }

            const articleIds = Object.keys(newsDatabase.articles);
            const currentIndex = articleIds.indexOf(currentId);
            
            const prevLink = getElement('prev-article');
            const nextLink = getElement('next-article');
            
            // ä¸Šä¸€ç¯‡
            if (prevLink) {
                if (currentIndex > 0) {
                    const prevId = articleIds[currentIndex - 1];
                    prevLink.href = `?id=${prevId}`;
                    prevLink.style.visibility = 'visible';
                    if (!GameState.isUnlocked(prevId)) {
                        prevLink.style.color = '#999';
                        prevLink.title = 'æœªè§£é”';
                    } else {
                        prevLink.style.color = '';
                        prevLink.title = '';
                    }
                } else {
                    prevLink.style.visibility = 'hidden';
                }
            }
            
            // ä¸‹ä¸€ç¯‡
            if (nextLink) {
                if (currentIndex < articleIds.length - 1) {
                    const nextId = articleIds[currentIndex + 1];
                    nextLink.href = `?id=${nextId}`;
                    nextLink.style.visibility = 'visible';
                    if (!GameState.isUnlocked(nextId)) {
                        nextLink.style.color = '#999';
                        nextLink.title = 'æœªè§£é”';
                    } else {
                        nextLink.style.color = '';
                        nextLink.title = '';
                    }
                } else {
                    nextLink.style.visibility = 'hidden';
                }
            }
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–...');
            
            // åŠ è½½æ•°æ®
            const loaded = await loadNewsData();
            if (!loaded) {
                console.error('æ•°æ®åŠ è½½å¤±è´¥ï¼Œåœæ­¢åˆå§‹åŒ–');
                return;
            }

            // è·å–æ–‡ç« IDå¹¶æ¸²æŸ“
            const articleId = getArticleIdFromUrl();
            console.log('å½“å‰æ–‡ç« ID:', articleId);
            renderArticle(articleId);

            // å­—ä½“ç¼©æ”¾åŠŸèƒ½
            let baseFontSize = 18;
            
            document.querySelectorAll('[data-action]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const action = btn.dataset.action;
                    const zoomTarget = getElement('ozoom');
                    
                    if (action === 'zoom-in') {
                        baseFontSize = Math.min(baseFontSize + 1, 24);
                        if (zoomTarget) zoomTarget.style.fontSize = baseFontSize + 'px';
                    } else if (action === 'zoom-out') {
                        baseFontSize = Math.max(baseFontSize - 1, 14);
                        if (zoomTarget) zoomTarget.style.fontSize = baseFontSize + 'px';
                    } else if (action === 'copy') {
                        if (!zoomTarget) return;
                        
                        const text = Array.from(zoomTarget.querySelectorAll('p'))
                            .map(p => p.innerText).join('\n');
                            
                        if (navigator.clipboard) {
                            navigator.clipboard.writeText(text).then(() => alert('å¤åˆ¶æˆåŠŸ'));
                        } else {
                            const temp = document.createElement('textarea');
                            temp.value = text;
                            document.body.appendChild(temp);
                            temp.select();
                            document.execCommand('copy');
                            document.body.removeChild(temp);
                            alert('å¤åˆ¶æˆåŠŸ');
                        }
                    }
                });
            });

            // è¿”å›é¡¶éƒ¨
            const goTop = getElement('go-top');
            if (goTop) {
                goTop.addEventListener('click', () => {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });

                window.addEventListener('scroll', () => {
                    if (window.scrollY > 400) {
                        goTop.style.opacity = 1;
                        goTop.style.pointerEvents = 'auto';
                    } else {
                        goTop.style.opacity = 0;
                        goTop.style.pointerEvents = 'none';
                    }
                });
            }
        });
    </script>
</body>
</html>
