<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>警务综合信息系统 | POLICE INTEGRATED SYSTEM</title>

<style>
/* ========== 变量 ========== */
:root {
  --bg: #f5f5f0;
  --black: #1a1a1a;
  --gray: #666;
  --accent: #c41e3a;
  --accent-dark: #8b0000;
  --accent-light: #e74c3c;
  --white: #fff;
  --grid-color: rgba(0, 0, 0, 0.06);
  --warning: #d4af37;
  --paper: #fafaf8;
}

/* ========== 基础 ========== */
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  background: var(--bg);
  font-family: "SF Pro Text", "Noto Sans SC", "Source Han Sans CN",
               system-ui, -apple-system, sans-serif;
  color: var(--black);
  position: relative;
  overflow: hidden;
}

/* ========== 背景装饰 ========== */
.bg-decorations {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
  background-image: 
    linear-gradient(var(--grid-color) 1px, transparent 1px),
    linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
  background-size: 50px 50px;
}

.decor-line {
  position: absolute;
  background: var(--accent);
  opacity: 0.1;
}

.decor-line.horizontal {
  width: 100%;
  height: 2px;
}

.decor-line.vertical {
  height: 100%;
  width: 2px;
}

.warning-tape {
  position: absolute;
  background: repeating-linear-gradient(
    45deg,
    var(--warning),
    var(--warning) 10px,
    #000 10px,
    #000 20px
  );
  opacity: 0.05;
  pointer-events: none;
}

/* ========== 页面框架 ========== */
.page {
  width: 100vw;
  height: 100vh;
  padding: 28px 36px;
  display: grid;
  grid-template-columns: 280px 1fr;
  grid-template-rows: auto auto 1fr auto;
  gap: 20px;
  position: relative;
  z-index: 1;
}

/* ========== 标题区 ========== */
header {
  grid-column: 1 / 3;
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  position: relative;
  border-bottom: 2px solid var(--black);
  padding-bottom: 16px;
}

.logo {
  font-size: 20px;
  letter-spacing: 0.15em;
  position: relative;
  padding-left: 20px;
  font-weight: 600;
}

.logo::before {
  content: "";
  position: absolute;
  left: 0;
  top: 0;
  width: 8px;
  height: 100%;
  background: var(--accent);
}

.logo span {
  display: block;
  font-size: 11px;
  color: var(--gray);
  margin-top: 6px;
  letter-spacing: 0.2em;
  font-weight: 400;
}

.badge {
  background: var(--accent);
  color: var(--white);
  padding: 6px 16px;
  font-size: 11px;
  letter-spacing: 0.1em;
  font-weight: 600;
  border-radius: 2px;
  position: relative;
  overflow: hidden;
}

.badge::after {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
  animation: shine 3s infinite;
}

@keyframes shine {
  0% { left: -100%; }
  20% { left: 100%; }
  100% { left: 100%; }
}

/* ========== 搜索区 ========== */
.search-area {
  grid-column: 1 / 3;
  background: var(--white);
  padding: 18px 24px;
  display: flex;
  align-items: center;
  gap: 20px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  border-left: 4px solid var(--accent);
  position: relative;
}

.search-label {
  font-size: 12px;
  letter-spacing: 0.15em;
  color: var(--gray);
  display: flex;
  align-items: center;
  gap: 10px;
  font-weight: 600;
  min-width: 80px;
}

.search-label::before {
  content: "◼";
  color: var(--accent);
  font-size: 10px;
}

.search-input-container {
  flex: 1;
  display: flex;
  align-items: center;
  gap: 12px;
  position: relative;
}

.search-input {
  background: #fafafa;
  border: 1px solid #ddd;
  border-left: 3px solid var(--accent);
  padding: 10px 14px;
  font-size: 16px;
  font-family: "SF Mono", "Consolas", monospace;
  letter-spacing: 0.15em;
  outline: none;
  flex: 1;
  transition: all 0.2s;
  color: var(--black);
  text-transform: uppercase;
}

.search-input:focus {
  border-color: var(--accent);
  background: var(--white);
  box-shadow: 0 0 0 3px rgba(196, 30, 58, 0.1);
}

.search-hint {
  font-size: 11px;
  color: var(--gray);
  letter-spacing: 0.05em;
  background: #f0f0f0;
  padding: 4px 10px;
  border-radius: 2px;
  font-family: monospace;
}

.search-status {
  position: absolute;
  right: 140px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 11px;
  color: var(--accent);
  opacity: 0;
  transition: opacity 0.3s;
  font-family: monospace;
}

.search-status.active {
  opacity: 1;
}

.input-hint {
  position: absolute;
  bottom: -24px;
  left: 100px;
  font-size: 10px;
  color: var(--gray);
  letter-spacing: 0.05em;
}

/* ========== 文档列表 ========== */
aside {
  border-right: 1px solid #ddd;
  padding-right: 20px;
  position: relative;
  background: rgba(255,255,255,0.5);
  padding: 20px;
  border: 1px solid #ddd;
  border-right: none;
}

aside h3 {
  font-size: 11px;
  letter-spacing: 0.15em;
  margin: 0 0 16px 0;
  display: flex;
  align-items: center;
  gap: 8px;
  color: var(--gray);
  font-weight: 600;
  padding-bottom: 12px;
  border-bottom: 1px solid #eee;
}

aside h3::before {
  content: "●";
  color: var(--accent);
  font-size: 8px;
}

.doc-list {
  display: flex;
  flex-direction: column;
  gap: 10px;
  max-height: calc(100vh - 300px);
  overflow-y: auto;
}

.doc-item {
  background: var(--white);
  color: var(--black);
  padding: 14px 16px;
  font-size: 12px;
  cursor: pointer;
  border: 1px solid #e0e0e0;
  transition: all 0.2s;
  position: relative;
  overflow: hidden;
  letter-spacing: 0.05em;
  border-left: 3px solid transparent;
}

.doc-item::before {
  content: "";
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background: var(--accent);
  opacity: 0;
  transition: opacity 0.3s;
  z-index: 0;
}

.doc-item:hover {
  border-left-color: var(--accent);
  transform: translateX(4px);
  box-shadow: 2px 2px 8px rgba(0,0,0,0.08);
}

.doc-item:hover::before {
  opacity: 0.03;
}

.doc-item.active {
  background: var(--accent);
  color: var(--white);
  border-color: var(--accent);
  border-left-color: var(--accent-dark);
  font-weight: 500;
}

.doc-item.active .doc-meta {
  color: rgba(255,255,255,0.8);
}

.doc-item .doc-type {
  font-size: 10px;
  color: var(--accent);
  margin-bottom: 4px;
  font-weight: 600;
  letter-spacing: 0.1em;
  position: relative;
  z-index: 1;
}

.doc-item.active .doc-type {
  color: rgba(255,255,255,0.9);
}

.doc-item .doc-title {
  position: relative;
  z-index: 1;
  font-weight: 500;
}

.doc-item .doc-meta {
  font-size: 10px;
  color: var(--gray);
  margin-top: 6px;
  letter-spacing: 0.05em;
  position: relative;
  z-index: 1;
  font-family: monospace;
}

.doc-item.public {
  border-left-color: var(--warning);
}

.doc-item.public::after {
  content: "公开";
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 9px;
  background: var(--warning);
  color: #000;
  padding: 2px 6px;
  border-radius: 2px;
  font-weight: 600;
  letter-spacing: 0.05em;
}

.doc-item.active.public::after {
  background: rgba(255,255,255,0.9);
  color: var(--accent);
}

/* ========== 内容区 - 文档样式 ========== */
main {
  position: relative;
  padding: 40px 48px;
  background: var(--paper);
  border: 1px solid #ddd;
  overflow-y: auto;
  box-shadow: 0 2px 12px rgba(0,0,0,0.06);
  font-family: "Noto Serif SC", "Source Han Serif CN", "SimSun", serif;
  line-height: 1.8;
  color: #222;
}

/* 文档头部 */
.doc-header {
  text-align: center;
  margin-bottom: 32px;
  padding-bottom: 24px;
  border-bottom: 2px solid var(--black);
}

.doc-header-title {
  font-size: 22px;
  font-weight: 600;
  letter-spacing: 0.2em;
  margin-bottom: 12px;
  font-family: "Noto Serif SC", serif;
}

.doc-header-meta {
  font-size: 12px;
  color: var(--gray);
  font-family: monospace;
  letter-spacing: 0.05em;
  line-height: 1.6;
}

/* 文档正文 */
.doc-body {
  font-size: 14px;
  text-align: justify;
  max-width: 100%;
}

/* 章节标题 */
.doc-section-title {
  font-size: 16px;
  font-weight: 600;
  margin-top: 28px;
  margin-bottom: 16px;
  letter-spacing: 0.1em;
  text-align: center;
  font-family: "Noto Serif SC", serif;
}

/* 子标题 */
.doc-subtitle {
  font-size: 14px;
  font-weight: 600;
  margin-top: 20px;
  margin-bottom: 12px;
  letter-spacing: 0.05em;
}

/* 普通段落 */
.doc-paragraph {
  /* 移除text-indent: 2em; */
  padding-left: 2em; /* 整段左侧缩进2em，换行后也生效 */
  margin-bottom: 12px;
  text-align: justify;
  /* 若需要用\n换行，保留这行；仅用<br>则可删 */
  white-space: pre-line; 
}

/* 无缩进段落单独重置 */
.doc-paragraph.no-indent {
  padding-left: 0; /* 无缩进段落取消左侧padding */
}

/* 列表项 */
.doc-list-item {
  margin-bottom: 8px;
  padding-left: 2em;
  text-indent: -2em;
  padding-left: 2em;
}

/* 表格 */
.doc-table {
  width: 100%;
  border-collapse: collapse;
  margin: 16px 0;
  font-size: 13px;
  font-family: "Noto Sans SC", sans-serif;
}

.doc-table th,
.doc-table td {
  border: 1px solid #999;
  padding: 8px 12px;
  text-align: left;
}

.doc-table th {
  background: #f0f0f0;
  font-weight: 600;
}

.doc-table tr:nth-child(even) {
  background: #f8f8f8;
}

/* 引用块（短信/对话） */
.doc-quote {
  margin: 16px 0;
  padding: 12px 16px;
  background: #f5f5f5;
  border-left: 3px solid #999;
  font-family: "Noto Sans SC", sans-serif;
  font-size: 13px;
  line-height: 1.6;
}

.doc-quote-header {
  font-weight: 600;
  color: var(--accent);
  margin-bottom: 6px;
  font-size: 12px;
}

/* 签名区域 */
.doc-signature {
  margin-top: 40px;
  text-align: right;
  font-size: 14px;
}

.doc-signature-line {
  margin-bottom: 8px;
}

/* 页脚 */
.doc-footer {
  margin-top: 48px;
  padding-top: 16px;
  border-top: 1px solid #ccc;
  font-size: 12px;
  color: var(--gray);
  text-align: center;
  font-family: monospace;
}

/* 密级标记 */
.classified-mark {
  position: absolute;
  top: 20px;
  right: 40px;
  font-size: 14px;
  color: var(--accent);
  border: 2px solid var(--accent);
  padding: 4px 12px;
  letter-spacing: 0.2em;
  font-weight: 600;
  transform: rotate(-5deg);
  opacity: 0.6;
}

/* 空状态 */
.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  color: var(--gray);
  min-height: 400px;
  font-family: "Noto Sans SC", sans-serif;
}

.empty-state .icon {
  width: 80px;
  height: 80px;
  border: 3px solid #ddd;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 24px;
  position: relative;
  background: #fafafa;
}

.empty-state .icon::before,
.empty-state .icon::after {
  content: "";
  position: absolute;
  background: #ccc;
}

.empty-state .icon::before {
  width: 3px;
  height: 36px;
}

.empty-state .icon::after {
  width: 36px;
  height: 3px;
}

.empty-state h2 {
  font-size: 16px;
  margin-bottom: 12px;
  letter-spacing: 0.15em;
  color: var(--black);
  font-weight: 600;
}

.empty-state p {
  font-size: 12px;
  text-align: center;
  max-width: 400px;
  line-height: 1.8;
  color: var(--gray);
}

.empty-state .hint-box {
  margin-top: 24px;
  padding: 16px 24px;
  background: #f5f5f5;
  border-left: 3px solid var(--accent);
  font-size: 11px;
  color: #666;
  font-family: monospace;
  text-align: left;
  max-width: 520px;
  line-height: 2;
}

.empty-state .hint-box strong {
  color: var(--accent);
  display: block;
  margin-bottom: 8px;
  font-family: sans-serif;
}

.doc-type-legend {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 4px 20px;
  margin-top: 8px;
}

/* ========== 底部状态区 ========== */
footer {
  grid-column: 1 / 3;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-top: 2px solid var(--black);
  padding-top: 16px;
  font-size: 11px;
  letter-spacing: 0.1em;
  color: var(--gray);
}

.status {
  display: flex;
  align-items: center;
  gap: 10px;
}

.status::before {
  content: "";
  width: 8px;
  height: 8px;
  background: var(--accent);
  border-radius: 50%;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.security-level {
  background: var(--black);
  color: var(--white);
  padding: 4px 12px;
  font-size: 10px;
  letter-spacing: 0.1em;
}

/* ========== 响应式 ========== */
@media (max-width: 1200px) {
  .page {
    grid-template-columns: 240px 1fr;
  }
  main {
    padding: 32px;
  }
}
</style>
</head>

<body>

<!-- 背景装饰 -->
<div class="bg-decorations">
  <div class="decor-line horizontal" style="top: 25%;"></div>
  <div class="decor-line horizontal" style="top: 75%;"></div>
  <div class="decor-line vertical" style="left: 20%;"></div>
  <div class="decor-line vertical" style="left: 80%;"></div>
  <div class="warning-tape" style="top: 10%; left: 0; width: 100%; height: 20px; transform: rotate(-2deg);"></div>
</div>

<div class="page">

  <header>
    <div class="logo">
      警务综合信息系统
      <span>POLICE INTEGRATED INFORMATION SYSTEM · 内部资料 注意保密</span>
    </div>
    <div class="badge">内部系统</div>
  </header>

  <div class="search-area">
    <div class="search-label">案件编码</div>
    <div class="search-input-container">
      <input 
        id="searchInput" 
        class="search-input" 
        placeholder="请输入12位案件编码..." 
        maxlength="12"
        autocomplete="off"
      />
      <div class="search-status" id="searchStatus">查询中...</div>
      <div class="search-hint">按 Enter 确认查询</div>
    </div>
    <div class="input-hint">格式：YYMMDD(6位) + 类型(2位) + 序号(3位) + 文档类型(1位字母)</div>
  </div>

  <aside>
    <h3>已解锁档案</h3>
    <div class="doc-list" id="docList">
      <!-- 文档列表将通过JavaScript动态生成 -->
    </div>
  </aside>

  <main id="mainContent">
    <div class="empty-state" id="emptyState">
      <div class="icon"></div>
      <h2>未选择档案</h2>
      <p>请在上方搜索栏输入12位案件编码以调取相关档案资料</p>
      <div class="hint-box">
        <strong>编码结构说明：YYMMDD + 类型(2位) + 序号(3位) + 文档类型(1位字母)</strong>
        <div class="doc-type-legend">
          <span>01 - 杀人案  02 - 抢劫案  03 - 盗窃案</span>
          <span>04 - 诈骗案  05 - 伤害案  06 - 毒品案</span>
        </div>
        <div style="margin-top: 8px; border-top: 1px solid #ddd; padding-top: 8px;">
          <strong>文档类型：</strong>
          B=报案记录  K=现场勘查  S=尸检报告  W=物证报告  X=询问笔录  D=电子数据  L=系统手册  M=监控数据  E=员工名单
        </div>
        <div style="margin-top: 8px; color: var(--accent);">
          重点案件：25111101001系列（林静怡被杀案）<br>监控数据编码：25111101001M (将跳转至监控页面)<br>员工名单编码：25111101001E (昨日提希丰会所员工名单)
        </div>
      </div>
    </div>
    <div id="docContent" style="display: none;">
      <div class="classified-mark">内部资料</div>
      <div class="doc-header">
        <div class="doc-header-title" id="docTitle"></div>
        <div class="doc-header-meta" id="docMeta"></div>
      </div>
      <div class="doc-body" id="docText"></div>
      <div class="doc-footer" id="docFooter"></div>
    </div>
  </main>

  <footer>
    <div class="status">系统运行正常 | 数据最后同步：2026-02-25 14:32:08</div>
    <div class="security-level">保密级别：内部</div>
  </footer>

</div>

<script>
/* ========== 文档类型映射 ========== */
const docTypeMap = {
  'B': { name: '报案记录', fullName: '报案登记表' },
  'K': { name: '现场勘查', fullName: '现场勘验检查笔录' },
  'S': { name: '尸检报告', fullName: '法医学尸体检验鉴定书' },
  'W': { name: '物证报告', fullName: '物证检验鉴定书' },
  'X': { name: '询问笔录', fullName: '询问笔录' },
  'D': { name: '电子数据', fullName: '电子数据取证报告' },
  'L': { name: '系统手册', fullName: '系统使用手册' },
  'M': { name: '监控数据', fullName: '监控视频与轨迹数据' },
  // 新增员工名单类型E
  'E': { name: '员工名单', fullName: '提希丰会所员工信息表' }
};

/* ========== 案件类型映射 ========== */
const caseTypeMap = {
  // 一、刑事案件（刑事警察/侦查部门使用）
  '01': '故意杀人案',
  '02': '抢劫案',
  '03': '盗窃案',
  '04': '诈骗案（含电信诈骗）',
  '05': '故意伤害案',
  '06': '毒品犯罪案',
  '07': '经济犯罪案（含涉众型）',
  '08': '计算机网络犯罪案',
  '09': '涉黑涉恶案',
  '10': '其他刑事案件',
  
  // 二、行政（治安）案件（治安警察/派出所使用）
  '11': '扰乱秩序案（原治安案细化）',
  '12': '寻衅滋事案',
  '13': '殴打他人案',
  '14': '盗窃（治安）案',
  '15': '毒品（行政）案',
  '16': '其他治安案件',
  
  // 三、交通与消防（交警/消防/派出所）
  '17': '交通事故案',
  '18': '交通肇事案（刑事）',
  '19': '火灾事故案',
  '20': '消防行政处罚案'
};

/* ========== 案件25111101001完整档案数据库 ========== */
const documents = {
  // ==================== 1. 报案记录 ====================
  "25111101001B": {
    code: "25111101001B",
    date: "2025-11-11",
    caseType: "01",
    caseTypeName: "杀人案",
    seq: "001",
    docType: "B",
    docTypeName: "报案记录",
    title: "报案登记表",
    caseNo: "A440305202511110001",
    location: "南山市南山区提希丰会所",
    isKeyCase: true,
    content: [
      {
        type: "text",
        text: "报案时间：2025年11月11日 06时47分。报案人：刘某某，提希丰会所夜班经理。报案方式：110电话报警。案发地点：南山区提希丰会所VIP理疗舱03号舱室。"
      },
      {
        type: "section",
        title: "案情摘要"
      },
      {
        type: "text",
        text: "报案人称当日早晨6时30分进行日常巡检时，发现VIP理疗舱03号舱室内有一名女性客人失去意识，颈部有血迹。经初步确认，该客人已死亡。"
      },
      {
        type: "text",
        text: "死者身份：林静怡，女，40岁，千禧会计事务所高级会计师。入住记录显示：11月10日23时15分通过SBTP合作渠道入住，电子授权书已签署。会所立即封锁现场，禁止人员出入，等待警方到达。"
      },
      {
        type: "text",
        text: "报案人强调：会所所有出入口监控正常运行，夜间仅有一名前台值班；VIP区域监控因\"客户预约隐私保护\"处于关闭状态。"
      },
      {
        type: "section",
        title: "初步处置"
      },
      {
        type: "list",
        items: [
          "06时52分 辖区派出所民警到达现场，初步确认死亡",
          "07时10分 刑侦大队技术中队派员到场",
          "07时35分 现场初步勘验开始，发现颈部创口及血迹异常",
          "08时00分 法医初步检查确认他杀嫌疑，案件移交刑警支队",
          "08时30分 现场全面封锁，技术大队正式介入"
        ]
      },
      {
        type: "section",
        title: "特殊标记"
      },
      {
        type: "text",
        text: "死者血型：AB型Rh阴性（熊猫血），罕见血型，占人群比例不足0.5%。死者身份敏感：千禧会计事务所项目质量控制复核人，近期负责翊尘投资审计项目。系统关联：死者通过SBTP智慧商旅通系统预订并改签，案发全程处于系统监控范围内。建议：同步调取SBTP系统后台数据，排查信息操控痕迹。"
      }
    ]
  },

  // ==================== 2. 现场勘查 ====================
  "25111101001K": {
    code: "25111101001K",
    date: "2025-11-11",
    caseType: "01",
    caseTypeName: "杀人案",
    seq: "001",
    docType: "K",
    docTypeName: "现场勘查",
    title: "现场勘验检查笔录",
    caseNo: "A440305202511110001",
    location: "南山市南山区提希丰会所VIP区03号理疗舱",
    content: [
      {
        type: "text",
        text: "案发时间：2025年11月10日23时50分至11月11日01时15分（推断）。勘查时间：2025年11月11日09时15分至12时30分。勘查地点：南山区提希丰会所VIP区03号量子生物反馈理疗舱。环境条件：室内恒温24℃，相对湿度55%，密闭空间。"
      },
      {
        type: "section",
        title: "现场方位及环境"
      },
      {
        type: "text",
        text: "提希丰会所位于南山区科技园南区，独立建筑共3层。VIP区位于2层东侧，共6个独立理疗舱。03号舱位于VIP区最内侧，面积约15平方米，内设水晶舱外观理疗设备一台、休憩躺椅、独立卫浴。舱门为电子密码锁，刷卡进入。案发时门处于关闭状态，无撬压痕迹。会所大堂、走廊监控覆盖完整，但VIP区域监控处于\"隐私保护模式\"（23时50分至01时15分时段）。"
      },
      {
        type: "section",
        title: "尸体位置及状态"
      },
      {
        type: "text",
        text: "死者位于理疗舱中央水晶舱内，仰卧位，盖有白色浴巾。颈部左侧见3处短刺创，呈直线排列，间距约1.5厘米。创缘整齐，创角上锐下钝。现场血迹异常稀少：水晶舱底部见少量血泊（15cm×10cm），舱侧面内壁见擦拭状血痕（Luminol阳性）。死者右手食指指甲缝提取到微量金属碎屑及皮肤组织。左手腕部见轻微束缚痕迹（宽1.5cm，软质束缚带特征）。休憩躺椅呈展开状态，寝具上有轻微压痕，呈人体仰卧形态。"
      },
      {
        type: "section",
        title: "痕迹物证提取"
      },
      {
        type: "list",
        items: [
          "物证1：水晶舱内提取毛发3根（已编号送检）",
          "物证2：死者指甲缝提取物（金属碎屑+人体表皮细胞）",
          "物证3：舱内空气过滤系统提取微量气溶胶样本",
          "物证4：理疗舱温控系统记录芯片（关键电子证据）",
          "物证5：门锁刷卡记录（23时15分入住刷卡，次日无外出记录）",
          "物证6：死者随身物品：iPhone 16 Pro 1部（未锁屏）、身份证、会议资料、现金2300元",
          "物证7：垃圾桶内一次性蓝色医用口罩1个",
          "物证8：探针组件收纳盒（标准4套，实存3套，缺失序列号-023）"
        ]
      },
      {
        type: "section",
        title: "监控异常情况"
      },
      {
        type: "text",
        text: "大堂监控（23时00分至23时15分）：林静怡进入画面，与前台王某某交谈，低头操作手机约30秒，随后离开。西侧门接驳点（23时14分至23时30分）：志愿者李某带林静怡到达，核对车牌A-07后上车。司机钱某，电瓶车23时30分驶离。"
      },
      {
        type: "text",
        text: "VIP入口（23时44分至23时46分）：电瓶车停靠，一名穿深色西装、戴口罩男性接应，工牌隐约可见\"技术部\"字样。VIP走廊（23时50分至01时15分）：隐私保护模式，无画面。系统日志：\"客户预约-隐私模式-3号舱\"。理疗舱室内（00时00分至01时15分）：健康监测摄像头数据上传中断，系统日志显示\"维护关闭\"。外围停车区（01时22分）：一名男性驾驶无标识黑色电瓶车离开，身形与VIP入口接应者相似。"
      },
      {
        type: "section",
        title: "现场分析意见"
      },
      {
        type: "text",
        text: "作案手法高度专业：创口短而深（≤3cm），角度一致（水平向后偏内），符合医疗背景人员操作。现场清理痕迹明显：血迹量与创口数量不匹配（体内缺失约600ml血液），存在事后清理。监控盲区精准利用：隐私保护模式申请时间与案发时间高度吻合，存在预谋。"
      },
      {
        type: "text",
        text: "特殊发现：死者体内缺失血液约600ml，疑似被采集；死者为AB型Rh阴性熊猫血。建议重点排查：具备医疗背景、熟悉会所系统操作、当日22时45分前后在会所附近出现的人员；追查缺失探针组件下落。"
      }
    ]
  },

  // ==================== 3. 尸检报告 ====================
  "25111101001S": {
    code: "25111101001S",
    date: "2025-11-12",
    caseType: "01",
    caseTypeName: "杀人案",
    seq: "001",
    docType: "S",
    docTypeName: "尸检报告",
    title: "法医学尸体检验鉴定书",
    caseNo: "A440305202511110001",
    location: "南山市公安局法医检验中心",
    content: [
      {
        type: "text",
        text: "死者姓名：林静怡，女，40岁，汉族，千禧会计事务所高级会计师。身份证号：4403XXXXXXXXXXXXXX。尸体发现时间：2025年11月11日06时30分。尸检时间：2025年11月11日14时30分至18时30分。主检法医：陈志明（主任法医师）。"
      },
      {
        type: "section",
        title: "尸表检验"
      },
      {
        type: "text",
        text: "一般情况：尸长165cm，体重58kg，发育正常，营养良好。尸斑：淡红色，位于背侧未受压部位，指压褪色。尸僵：存在于全身各大关节，强度中等。衣着：深蓝色Theory西装外套、白色真丝衬衫、黑色西装裤。衬衫领口左侧有血迹浸润（3cm×2cm）。特殊体表：双侧眼结膜轻度充血（疲劳状态）；左前臂外侧陈旧性疤痕（2cm，接种疤痕）。"
      },
      {
        type: "section",
        title: "颈部创口检验"
      },
      {
        type: "text",
        text: "创口分布：颈部左侧，胸锁乳突肌前缘，共3处刺入创，呈直线排列，间距约1.5cm。"
      },
      {
        type: "table",
        headers: ["创口", "距锁骨上缘", "长度", "深度", "方向"],
        rows: [
          ["A", "3.2cm", "2.8cm", "3.0cm", "水平向后偏内"],
          ["B", "4.8cm", "2.9cm", "3.1cm", "水平向后偏内"],
          ["C", "6.3cm", "2.7cm", "3.0cm", "水平向后偏内"]
        ]
      },
      {
        type: "text",
        text: "创口特征：创缘整齐，无拖拽痕迹；创角上锐下钝（单刃锐器）；创道深度一致，全层刺入；周围无表皮剥脱（快速精准操作）。致伤工具推断：单刃小型锐器，刀刃宽度≤3cm，薄而锋利，符合手术刀或战地医疗器具特征。"
      },
      {
        type: "section",
        title: "内部检验与死因"
      },
      {
        type: "text",
        text: "颈部解剖：创道穿透颈阔肌、胸锁乳突肌，达颈动脉鞘；左侧颈总动脉完全断裂，颈内静脉部分断裂；气管、食管未受损。死因：左侧颈部锐器刺创致颈总动脉断裂，急性失血性休克死亡。"
      },
      {
        type: "text",
        text: "失血量评估：颈部软组织内积血约150ml；现场血迹约400ml；估测总失血量应超1000ml，但体内仅存留约400ml → 缺失约600ml血液。"
      },
      {
        type: "section",
        title: "特殊发现"
      },
      {
        type: "text",
        text: "血型：AB型Rh阴性（熊猫血），占人群比例不足0.5%。采血痕迹：左肘正中静脉穿刺点，符合医疗采血操作，采血量估计约200-400ml。指甲缝残留：灰白色金属样微粒，成分分析为不锈钢316L（铬18%、镍8%、铁72%），与提希丰会所理疗舱探针组件材质一致。死亡时间：2025年11月11日00时45分至01时15分。镇静痕迹：脂肪组织中检出环苯扎林代谢物，提示死前2-4小时曾接触该镇静剂。"
      },
      {
        type: "section",
        title: "鉴定意见"
      },
      {
        type: "list",
        items: [
          "林静怡系被他人用单刃锐器（刀刃长≤3cm）多次刺击颈部，致颈总动脉断裂、失血性休克死亡",
          "死亡时间：2025年11月11日00时45分至01时15分",
          "死者生前曾接受静脉采血，采血量约200-400ml，采血时间在死亡前1小时内",
          "死者体内缺失血液约600ml，结合现场血迹分析，疑似被采集带走",
          "死者指甲缝检出金属微粒，与现场探针组件材质一致，提示与作案工具有直接接触",
          "案件性质：他杀，作案人员具备医疗专业背景，熟悉现场环境及系统操作"
        ]
      }
    ]
  },

  // ==================== 4. 物证报告 ====================
  "25111101001W": {
    code: "25111101001W",
    date: "2025-11-13",
    caseType: "01",
    caseTypeName: "杀人案",
    seq: "001",
    docType: "W",
    docTypeName: "物证报告",
    title: "物证检验鉴定书",
    caseNo: "A440305202511110001",
    location: "南山市公安局刑事科学技术研究所",
    content: [
      {
        type: "section",
        title: "送检材料"
      },
      {
        type: "list",
        items: [
          "检材1：死者指甲缝提取物（金属碎屑及皮肤组织）",
          "检材2：现场提取毛发3根",
          "检材3：理疗舱温控系统记录芯片",
          "检材4：垃圾桶内一次性蓝色医用口罩",
          "检材5：探针组件收纳盒（剩余3套）",
          "检材6：现场气溶胶样本",
          "比对样本1：嫌疑人宋绪静血样、指纹、DNA",
          "比对样本2：礼宾员陈明血样、指纹",
          "比对样本3：会所其他员工生物样本"
        ]
      },
      {
        type: "section",
        title: "DNA检验结果"
      },
      {
        type: "text",
        text: "死者指甲缝皮肤组织：检出DNA与嫌疑人宋绪静血样在D8S1179等20个基因座分型一致，似然比率3.45×10²³。现场毛发：1根检出DNA与宋绪静认定同一；另外2根与死者认定同一。结论：宋绪静曾与死者发生肢体接触，且存在被动防御动作（指甲抓挠）。口罩内侧：检出DNA与宋绪静认定同一。"
      },
      {
        type: "section",
        title: "微量物证分析"
      },
      {
        type: "text",
        text: "金属碎屑成分：不锈钢316L医用级合金，与提希丰会所理疗舱标配医疗探针组件材质完全一致。气溶胶分析：检出环苯扎林成分，证实该药物通过理疗舱温控系统雾化导入。探针组件：剩余3套序列号分别为-021、-022、-024，缺失-023号。缺失组件与死者指甲缝金属碎屑材质一致。口罩：普通蓝色医用口罩，品牌为稳健医疗，批号与会所采购批次一致。"
      },
      {
        type: "section",
        title: "电子数据检验"
      },
      {
        type: "text",
        text: "理疗舱温控芯片记录：23时05分系统启动，温度设定38.5℃；23时06分检测到异常物质注入（环苯扎林凝胶，通过温控系统雾化）；23时30分舱内人员生命体征下降（心率、呼吸频率降低）；00时00分健康监测摄像头数据上传中断；01时15分系统强制关闭，数据上传恢复。"
      },
      {
        type: "text",
        text: "门锁记录：23时15分死者刷卡进入；23时42分维护账号'test'远程开启（异常记录）；01时18分维护账号'test'远程关闭。"
      },
      {
        type: "section",
        title: "鉴定意见"
      },
      {
        type: "list",
        items: [
          "现场提取生物检材与嫌疑人宋绪静认定同一，证实其案发时在现场并与死者发生肢体冲突",
          "作案工具为理疗舱标配医疗探针组件（序列号-023），该组件缺失，其材质与死者指甲缝金属碎屑一致",
          "药物通过温控系统雾化导入，死者体内检出环苯扎林代谢物",
          "系统日志显示案发时段有未授权账号'test'远程操作理疗舱门锁及摄像头",
          "建议追查'test'账号使用者及权限来源，排查SBTP系统安全漏洞"
        ]
      }
    ]
  },

  // ==================== 5. 询问笔录 ====================
  "25111101001X": {
    code: "25111101001X",
    date: "2025-11-11",
    caseType: "01",
    caseTypeName: "杀人案",
    seq: "001",
    docType: "X",
    docTypeName: "询问笔录",
    title: "询问笔录（关键证人合集）",
    caseNo: "A440305202511110001",
    location: "南山公安分局刑警大队",
    content: [
      {
        type: "section",
        title: "证人一：酒店前台王某某（女，26岁）"
      },
      {
        type: "text",
        text: "询问时间：2025年11月11日16时至18时。"
      },
      {
        type: "quote",
        header: "问：请描述接待林静怡的过程。",
        content: "答：她大概晚上11点到前台，拖着行李箱，看起来挺累的。我查系统，显示商务房已满。"
      },
      {
        type: "quote",
        header: "问：然后提供了什么选项？",
        content: "答：三个选项：A等空房，B升级套房差价480，C免费转提希丰会所VIP理疗舱。系统显示\"合作方案已确认\"。"
      },
      {
        type: "quote",
        header: "问：她怎么选择的？",
        content: "答：她问了一句\"授权书是在手机上签吗\"，我说是。她看了眼手机，然后就选C了。"
      },
      {
        type: "quote",
        header: "问：后来发现什么异常？",
        content: "答：第二天发现商务房其实没满，凌晨有人取消。还有支付失败提示，重启就好了，挺奇怪的。"
      },
      {
        type: "section",
        title: "证人二：志愿者李某（男，19岁，深南大学学生）"
      },
      {
        type: "text",
        text: "询问时间：2025年11月11日19时30分至20时15分。"
      },
      {
        type: "quote",
        header: "问：带林静怡去接驳点的情况？",
        content: "答：前台叫我的，说SBTP贵宾要去提希丰。我帮她拎行李，带她去西侧门。"
      },
      {
        type: "quote",
        header: "问：路上聊天了吗？",
        content: "答：没怎么聊，她挺累的。快到的时候她看了眼手机，表情放松了一点，可能是授权书签完了。"
      },
      {
        type: "section",
        title: "证人三：接驳司机钱某（男，52岁）"
      },
      {
        type: "text",
        text: "询问时间：2025年11月11日20时30分至21时30分。"
      },
      {
        type: "quote",
        header: "问：描述一下当晚情况。",
        content: "答：我开电瓶车，车牌A-07。23时30分从酒店西侧门出发，送到提希丰VIP入口。"
      },
      {
        type: "quote",
        header: "问：送到后发生了什么？",
        content: "答：开到VIP入口，一个穿西装戴口罩的男人在门口等。他接过行李，林静怡看了他一眼，就跟他进去了。"
      },
      {
        type: "quote",
        header: "问：看清那个男人了吗？",
        content: "答：灯挺暗的，没看清脸。他工牌晃了一下，好像是技术部的？我还奇怪礼宾部怎么让技术部接客人。"
      },
      {
        type: "section",
        title: "证人四：提希丰礼宾员孙某（男，28岁）"
      },
      {
        type: "text",
        text: "询问时间：2025年11月12日9时至11时。"
      },
      {
        type: "quote",
        header: "问：接待林静怡的经过？",
        content: "答：系统弹窗提示\"SBTP商旅会员-合作升级-理疗舱预留\"，3号舱，最高优先级。显示\"电子授权书已签署\"。"
      },
      {
        type: "quote",
        header: "问：你见到她时的情况？",
        content: "答：她从VIP入口进来，我过去的时候，旁边有个穿西装的男人已经走了，就她一个人。她正在看手机。"
      },
      {
        type: "quote",
        header: "问：你跟她说了什么？",
        content: "答：我介绍这是合作升级包含的深度放松疗程，舱里可以过夜。我还说了一句\"系统维护员刚做过检测，设备都是好的\"。她问了一句\"安全吗\"，我说\"您锁好舱门就行，隐私模式开启后监控会关闭\"。她点点头就进去了。"
      },
      {
        type: "quote",
        header: "问：后来呢？",
        content: "答：系统显示凌晨1点15分\"客户已自主离舱\"，我以为她临时有事走了，就没再过问。"
      }
    ]
  },

  // ==================== 6. 电子数据取证 ====================
  "25111101001D": {
    code: "25111101001D",
    date: "2025-11-12",
    caseType: "01",
    caseTypeName: "杀人案",
    seq: "001",
    docType: "D",
    docTypeName: "电子数据",
    title: "电子数据取证报告",
    caseNo: "A440305202511110001",
    location: "南山市公安局网络安全保卫支队",
    content: [
      {
        type: "section",
        title: "取证对象"
      },
      {
        type: "list",
        items: [
          "对象1：死者林静怡 iPhone 16 Pro（IMEI：354601080768234）",
          "对象2：SBTP智慧商旅通系统后台日志",
          "对象3：提希丰会所服务器访问记录",
          "对象4：南山市国际酒店预订系统数据"
        ]
      },
      {
        type: "section",
        title: "短信记录提取"
      },
      {
        type: "sms",
        time: "14:23",
        sender: "铁路12306",
        content: "【退改签通知】G6011次取消，改签至G6028次（21:15-23:14）"
      },
      {
        type: "sms",
        time: "17:08",
        sender: "周变",
        content: "公司临时有事，我11号才能到。你改签了？晚上住哪？"
      },
      {
        type: "sms",
        time: "17:11",
        sender: "林静怡",
        content: "改到今晚10点多，到南山北就11点。酒店订的国际酒店会场店。"
      },
      {
        type: "sms",
        time: "20:47",
        sender: "南山市国际酒店",
        content: "【商旅会员专享】基于您的高频出行记录与战略合作协议，免费升级至提希丰VIP理疗舱"
      },
      {
        type: "sms",
        time: "22:03",
        sender: "2025智能会计前沿峰会组委会",
        content: "【重要提醒】请于今日24:00前完成会议材料预提交"
      },
      {
        type: "sms",
        time: "22:47",
        sender: "南山市国际酒店",
        content: "【支付失败提醒】房型升级订单因系统支付接口冲突失败"
      },
      {
        type: "sms",
        time: "23:12",
        sender: "SBTP智慧商旅通",
        content: "【接驳服务确认】23:30酒店西侧门乘坐电瓶车A-07"
      },
      {
        type: "sms",
        time: "23:15",
        sender: "林静怡",
        content: "刚到酒店，前台说房型有问题，让我去合作会所住，免费的，说是你说的那家提希丰。"
      },
      {
        type: "sms",
        time: "23:16",
        sender: "周变",
        content: "提希丰？环境挺好的，我之前年会去过。安全没问题，放心住。"
      },
      {
        type: "sms",
        time: "23:44",
        sender: "林静怡",
        content: "到会所了，有礼宾接。舱里能直接睡，明早车送。你忙完早点休息。【最后一条】"
      },
      {
        type: "section",
        title: "电子数据授权书"
      },
      {
        type: "text",
        text: "文件名称：SBTP_授权书_20251110_林静怡.pdf。生成时间：2025年11月10日23时12分47秒。文件哈希：3A7F9B21C4D8E6521F039A87B4C25D61。授权编号：SBTP-20251110-0842。"
      },
      {
        type: "text",
        text: "授权内容：授权南山市国际酒店与提希丰会所共享本人信息用于商旅服务结算验证，包括基础身份信息、行程信息、健康监测数据。有效期至2025年11月12日24时。电子签名：林静怡。签名IP：172.21.43.108（提希丰会所内网IP）。验真码：SBTP-2025-1110-0842-9F3A。"
      },
      {
        type: "section",
        title: "系统操控痕迹（关键发现）"
      },
      {
        type: "list",
        items: [
          "22:38 test账号查询林静怡身份证号、手机号",
          "22:40 test账号修改酒店房态：商务房标记为\"满房\"（实际有房）",
          "22:42 test账号修改林静怡预订标签为\"合作升级\"",
          "22:43 test账号触发\"支付失败\"提示",
          "22:44 test账号发送合作短信至林静怡手机",
          "22:45 test账号修改会所内网门户显示规则，对酒店IP段显示\"正式运营\"",
          "22:46 test账号向峰会组委会系统发送\"材料预提交提醒\"（实际截止时间为次日12:00）",
          "23:42 test账号远程开启03号舱门锁",
          "01:18 test账号远程关闭03号舱门锁，标记\"客户已自主离舱\""
        ]
      },
      {
        type: "section",
        title: "时间线重构"
      },
      {
        type: "text",
        text: "22:34 暗网订单接收（宋绪静笔记本恢复数据）。22:38 test账号开始查询林静怡信息（间隔4分钟）。23:12 林静怡签署电子授权书。23:30 电瓶车接驳。23:44 到达提希丰VIP入口，被\"技术部\"人员接应。23:50 进入03号舱，隐私模式开启。00:00 理疗舱启动，摄像头中断。00:45-01:15 死亡时间窗口。01:15 系统标记\"自主离舱\"。01:22 嫌疑人驾驶电瓶车离开。"
      }
    ]
  },

  // ==================== 7. 系统手册（公开） ====================
  "00000000000L": {
    code: "00000000000L",
    date: "2025-01-01",
    caseType: "00",
    caseTypeName: "系统",
    seq: "000",
    docType: "L",
    docTypeName: "系统手册",
    title: "系统使用手册",
    caseNo: "SYS-2025-001",
    location: "系统默认",
    isPublic: true,
    content: [
      {
        type: "text",
        text: "警务综合信息系统（PIIS）是面向公安机关内部使用的案件信息管理平台。本系统采用12位案件编码体系，实现案件资料的数字化管理与快速检索。系统严格遵循《公安机关办理刑事案件程序规定》及信息安全等级保护要求。"
      },
      {
        type: "section",
        title: "编码规则"
      },
      {
        type: "text",
        text: "案件编码共12位：日期(6位) + 案件类型(2位) + 序号(3位) + 文档类型(1位字母)。" +
              "日期格式：YYMMDD，如251111表示2025年11月11日。<br>" +
              "案件类型（共3类20种）：<br>" +
              "01故意杀人案、02抢劫案、03盗窃案、04诈骗案（含电信诈骗）、05故意伤害案、06毒品犯罪案、07经济犯罪案（含涉众型）、08计算机网络犯罪案、09涉黑涉恶案、10其他刑事案件；<br>" +
              "11扰乱秩序案（原治安案细化）、12寻衅滋事案、13殴打他人案、14盗窃（治安）案、15毒品（行政）案、16其他治安案件；<br>" +
              "17交通事故案、18交通肇事案（刑事）、19火灾事故案、20消防行政处罚案。<br><br>" +
              "序号：001-999，表示当日该类型案件顺序号。<br>" +
              "文档类型：B报案记录、K现场勘查、S尸检报告、W物证报告、X询问笔录、D电子数据、L系统手册、M监控数据、E员工名单。"
      },
      {
        type: "section",
        title: "案件提示"
      },
      {
        type: "text",
        text: "今日已上传：25111101001案件的相关内容。本案当前系统上已上传报案记录、现场勘查和尸检报告、物证报告、员工名单、笔录和电子数据取证的相关内容。监控数据当前未上传，但可通过编码直接跳转查看。"
      },
      {
        type: "section",
        title: "安全提示"
      },
      {
        type: "text",
        text: "系统内容涉及警务工作秘密，严禁截屏、拍照或对外泄露。重点案件数据访问需经授权，操作日志全程记录。技术支持：科信处 内线XXXX。"
      }
    ]
  },

  // ==================== 8. 新增文档：昨日员工名单 (E) ====================
  "25111101001E": {
    code: "25111101001E",
    date: "2025-11-11",
    caseType: "01",
    caseTypeName: "杀人案",
    seq: "001",
    docType: "E",
    docTypeName: "员工名单",
    title: "提希丰会所员工名单（2025年11月10日当值）",
    caseNo: "HR-20251110-TXF",
    location: "提希丰会所人力资源部",
    isKeyCase: true,  // 关联重点案件
    content: [
      {
        type: "section",
        title: "说明"
      },
      {
        type: "text",
        text: "本名单为提希丰会所2025年11月10日至11月11日的部分在岗员工信息，含姓名及10位工号ID。此名单已由会所人力资源部于11月11日10时提供，用于排查与林静怡案相关的人员。"
      },
      {
        type: "section",
        title: "员工名单"
      },
      {
        type: "table",
        headers: ["姓名", "工号ID (10位)", "部门", "当值时段"],
        rows: [         
          ["王莉", "TXF0452091", "前台接待", "20:00 - 08:00（夜班）"],
          ["孙启明", "TXF0321765", "礼宾部", "18:00 - 02:00"],
          ["李瑞", "TXF0983210", "志愿者（深南大学）", "19:00 - 23:30"],
          ["钱德平", "TXF0543321", "接驳车司机", "22:00 - 02:00"],
          ["陈明", "TXF0112987", "礼宾部", "22:00 - 06:00"],
          ["刘东伟", "TXF0678432", "安保部", "20:00 - 08:00"],
          ["张雅楠", "TXF0765123", "客服部", "18:00 - 02:00"],
          ["赵明", "TXF0432659", "技术部", "09:00 - 18:00"],
          ["宋绪静", "TXF0231087", "技术部（系统维护）", "02:00 - 14:00"],
          ["周明远", "TXF0896543", "后勤保障", "22:00 - 06:00"],
          ["林小华", "TXF0123987", "保洁部", "22:00 - 06:00"],
          ["吴茜", "TXF0554876", "前台接待", "14:00 - 22:00"]
        ]
      },
      {
        type: "section",
        title: "备注"
      },
      {
        type: "text",
        text: "1. 工号全部为10位，以'TXF'开头为提希丰正式员工编码；志愿者编码临时录入，仍为10位格式。"
      }
    ]
  }
};

const unlocked = {};
const docList = document.getElementById("docList");
const emptyState = document.getElementById("emptyState");
const docContent = document.getElementById("docContent");
const docTitle = document.getElementById("docTitle");
const docMeta = document.getElementById("docMeta");
const docText = document.getElementById("docText");
const docFooter = document.getElementById("docFooter");
const searchInput = document.getElementById("searchInput");
const searchStatus = document.getElementById("searchStatus");

/* ========== 初始化 - 加载公开文件 ========== */
function init() {
  // 默认解锁系统手册
  unlocked["00000000000L"] = documents["00000000000L"];
  renderList();
  // 默认打开手册
  openDoc("00000000000L");
}

/* ========== 验证编码格式 ========== */
function validateCode(code) {
  if (code.length !== 12) return false;
  const frontPart = code.substring(0, 11);
  if (!/^\d{11}$/.test(frontPart)) return false;
  const lastChar = code.substring(11, 12);
  if (!/^[A-Z]$/.test(lastChar)) return false;
  return true;
}

/* ========== 搜索解锁 ========== */
searchInput.addEventListener("keydown", e => {
  if (e.key !== "Enter") return;

  const key = e.target.value.trim().toUpperCase();
  
  if (!validateCode(key)) {
    e.target.style.borderColor = "#e74c3c";
    setTimeout(() => {
      e.target.style.borderColor = "";
    }, 500);
    e.target.placeholder = "格式错误：前11位数字，最后1位字母";
    e.target.value = "";
    return;
  }
  
  // 新增特殊逻辑：如果输入25111101001M，则弹窗并跳转
  if (key === "25111101001M") {
    alert("将转至监控相关页面直接进行查看");
    // 跳转到 jiankong.html
    window.location.href = "jiankong.html";
    return; // 停止后续处理
  }
  
  searchStatus.classList.add("active");
  
  setTimeout(() => {
    searchStatus.classList.remove("active");
    
    if (documents[key] && !unlocked[key]) {
      unlocked[key] = documents[key];
      renderList();
      openDoc(key);
      e.target.value = "";
      e.target.placeholder = "查询成功，请输入新的案件编码...";
    } else if (unlocked[key]) {
      openDoc(key);
      e.target.value = "";
    } else {
      e.target.style.borderColor = "#e74c3c";
      setTimeout(() => {
        e.target.style.borderColor = "";
      }, 500);
      e.target.placeholder = "该编码档案不存在";
      e.target.value = "";
    }
  }, 600);
});

/* ========== 渲染文档列表 ========== */
function renderList() {
  docList.innerHTML = "";
  const keys = Object.keys(unlocked);
  keys.sort();
  
  keys.forEach(key => {
    const doc = unlocked[key];
    const div = document.createElement("div");
    div.className = "doc-item" + (doc.isPublic ? " public" : "");
    
    let badge = "";
    if (doc.isKeyCase) {
      badge = '<span style="color: var(--accent); font-weight: bold;">[重点] </span>';
    }
    
    div.innerHTML = `
      <div class="doc-type">${doc.docTypeName}</div>
      <div class="doc-title">${badge}${doc.title}</div>
      <div class="doc-meta">${doc.code} | ${doc.date} | ${doc.caseTypeName}</div>
    `;
    div.onclick = () => openDoc(key);
    docList.appendChild(div);
  });
}

/* ========== 打开文档 ========== */
function openDoc(key) {
  const doc = unlocked[key];
  
  document.querySelectorAll(".doc-item").forEach((item, index) => {
    item.classList.remove("active");
    if (Object.keys(unlocked).sort()[index] === key) {
      item.classList.add("active");
    }
  });
  
  emptyState.style.display = "none";
  docContent.style.display = "block";
  
  docTitle.textContent = doc.title;
  
  let metaHtml = `案件编码：${doc.code} | 案发日期：${doc.date}<br>`;
  metaHtml += `案件类型：${doc.caseTypeName}(${doc.caseType}) | 文档类型：${doc.docTypeName}<br>`;
  if (doc.caseNo) {
    metaHtml += `档案编号：${doc.caseNo} | `;
  }
  if (doc.location) {
    metaHtml += `地点：${doc.location}`;
  }
  docMeta.innerHTML = metaHtml;
  
  // 渲染文档内容 - 新格式
  docText.innerHTML = "";
  
  doc.content.forEach(block => {
    if (block.type === "section") {
      const h2 = document.createElement("div");
      h2.className = "doc-section-title";
      h2.textContent = block.title;
      docText.appendChild(h2);
    }
    else if (block.type === "subtitle") {
      const h3 = document.createElement("div");
      h3.className = "doc-subtitle";
      h3.textContent = block.title;
      docText.appendChild(h3);
    }
    else if (block.type === "text") {
      const p = document.createElement("div");
      p.className = "doc-paragraph";
      p.innerHTML = block.text;
      docText.appendChild(p);
    }
    else if (block.type === "no-indent") {
      const p = document.createElement("div");
      p.className = "doc-paragraph no-indent";
      p.textContent = block.text;
      docText.appendChild(p);
    }
    else if (block.type === "list") {
      block.items.forEach(item => {
        const p = document.createElement("div");
        p.className = "doc-list-item";
        p.textContent = item;
        docText.appendChild(p);
      });
    }
    else if (block.type === "table") {
      const table = document.createElement("table");
      table.className = "doc-table";
      
      const thead = document.createElement("thead");
      const tr = document.createElement("tr");
      block.headers.forEach(h => {
        const th = document.createElement("th");
        th.textContent = h;
        tr.appendChild(th);
      });
      thead.appendChild(tr);
      table.appendChild(thead);
      
      const tbody = document.createElement("tbody");
      block.rows.forEach(row => {
        const tr = document.createElement("tr");
        row.forEach(cell => {
          const td = document.createElement("td");
          td.textContent = cell;
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      docText.appendChild(table);
    }
    else if (block.type === "quote") {
      const quote = document.createElement("div");
      quote.className = "doc-quote";
      quote.innerHTML = `
        <div class="doc-quote-header">${block.header}</div>
        <div>${block.content}</div>
      `;
      docText.appendChild(quote);
    }
    else if (block.type === "sms") {
      const sms = document.createElement("div");
      sms.className = "doc-quote";
      sms.innerHTML = `
        <div class="doc-quote-header">${block.time} 【${block.sender}】</div>
        <div>${block.content}</div>
      `;
      docText.appendChild(sms);
    }
  });
  
  // 页脚
  docFooter.innerHTML = `
    本文件由警务综合信息系统生成 | 生成时间：${new Date().toLocaleString('zh-CN')}<br>
    未经授权不得复制、传播 | 操作员编号：${Math.random().toString(36).substring(2, 8).toUpperCase()}
  `;
  
  document.getElementById("mainContent").scrollTop = 0;
}

/* ========== 输入处理 ========== */
searchInput.addEventListener("input", e => {
  e.target.value = e.target.value.toUpperCase();
  
  let value = e.target.value;
  if (value.length <= 11) {
    value = value.replace(/[^0-9]/g, '');
  } else {
    const front = value.substring(0, 11).replace(/[^0-9]/g, '');
    const end = value.substring(11, 12).replace(/[^A-Z]/gi, '').toUpperCase();
    value = front + end;
  }
  e.target.value = value;
  
  if (value.length === 12) {
    e.target.style.borderColor = "var(--accent-light)";
  } else {
    e.target.style.borderColor = "";
  }
});

/* ========== 初始化 ========== */
document.addEventListener("DOMContentLoaded", init);
</script>

</body>
</html>